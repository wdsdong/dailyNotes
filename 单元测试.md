##单元测试

###什么是单元测试

单元测试是开发者编写的一小段代码，用于检测被测代码中的一个很明确的功能是否正确。通常而言，一个单元测试是用于判断某个特定条件下某个特定函数的行为。

**执行单元测试，是为了证明某段代码的行为确实和开发者所期望的一致。**

###为什么要使用单元测试

* 单元测试使工作完成的更轻松

* 单元测试使你的设计更好

* 大大减少花在测试上的时间

* 能帮助你更好的理解代码

###没有单元测试

* 任何代码都是在假定其他代码是正确无误的情况下编写的

* 修改一处代码时，无法得知会对其他代码产生怎样的影响

* 任何一处改动都需要进行功能级别的整体调试


###单元测试最佳时间

```
实践一：
SetUp
输入
调用
输出
TearDown
```

```
实践二：
运行快速：单元测试运行很频繁，是辅助开发的，在开发过程中运行，如果慢影响很大
```

```
实践三：
一致性
任何时候同样的输入需要同样的结果
```

```
实践四：
原子性
所有的测试只有两种结果：成功和失败。不能部分测试通过
```
```
实践五：
单一原则
一个测试只验证一个行为
```

```
实践六：
独立无耦合
单个测试之间无相互调用：单元测试执行顺序无关；不同的顺序无影响
单元测试之间不能共享状态：如果必须共享可以放到 SetUp 里
```

```
实践七：
隔离外部调用
单元测试需要快速运行，且每次结果一直，所以需哟啊隔离一切对外部的调用
不适用具体的其他真实类，就是不要 new
不读数据库
不读网络
不读外部文件
不依赖本地时间
不依赖外部环境
适当时候可以构造一个相同的内部文件来 Mock
```

```
实践八：
自描述
单元测试是开发级文档
单元测试是方法的描述
```

```
实践九：
单元测试逻辑
单元测试必须容易读和理解的
无条件语句，无 Switch：分解 if 到多个测试，所有的输入都是已知的，所有的结果都是一定的
无循环语句
无异常捕捉
```

```
实践十：
断言
断言信息最好包含 Business Infomation
断言信息包含出错的具体信息如果失败
```

###单元测试价值所在

1. 减少低级错误

2. 减少调试时间

3. 描述代码行为：在撰写单元测试时，我们基本上都是假定某个方法，在某个特定的环境中，嫩能够有预期	的表现。

4. 可维护性强

5. 改善设计


###测试用例的三部曲

**为了验证某个类的某个行为在某种上下文中能得到预期的结果**

一个测试用例分为三个阶段：排列资源，执行行为，断言结果。

**要做到真正的单元测试，你需要保证每个测试用例所针对的仅仅是一个基本单元，而不是一个有很多复杂依赖的综合行为。**

###写代码的最终目标：

* 实现需求

* 提高代码质量和可维护性：代码的可维护性是指增加一个新功能，或改变现有功能的成本。成本越低，可维护性即越高。单元测试能提高代码质量和可维护性。

###应该测试什么
单元测试侧重的是逻辑测试和接口测试，以下几部分是可以进行测试的：

* 公共类中的公开方法

* 网络数据层

* 业务逻辑层

* 修复 Bug 的测试

